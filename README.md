# AIGameTranslater
## ВАЖНО: Всем привет. Сейчас кратко распишу, что это, для кого и зачем. Это наэкранный переводчик использующий мощность ВАШЕГО ПК за счет локальных нейросетей. Использование их позволяет получить более качественны перевод за счет понимания контекста. Если у вас слабенький ПК или вы думаете, что получете перевод уровня профессиональной студии, то спешу вас огорчить. Нейросети, как и мы, имеет свойство ошибаться, русский язык для них это тихий ужас, так что они спокойно могут путаться в склонениях слов или не понимания текста. Но в большинстве случаях они выдают реально красивый текст, который приятно читать. Если вы готовы простить этот момент (а так же мои ошибки в коде) или вам просто интеренсо как это рабоатет, то добро пожаловать.

Сделано мной совместно с Gemini.
- Немного истории: Мне просто надоело напрягать мозги или сидеть с переводчиком и переводить азиатские гача игры и визуальные новелы, поэтому я напечатал эту прогу (не совсем я, но руку точно приложил в некоторых местах)
## ОПИСАНИЕ (желательно всё прочитать, даже мою болтовню)
Работает по принципу: Раз в 1-2 секунды (можно настроить) делает скриншот области -> отправляет скриншот нейросети -> нейросеть распознает текст и переводит на русский -> выводит текст на экран (Profit)

## МИНИМАЛЬНЫЕ СИСТЕМНЫЕ ТРЕБОВАНИЯ (что бы хоть что-то показало/перевело и было комфортно):
1. Для режима ONLINE (Google Translate):
- GPU: 2-4 Гб видеопамяти (Для OCR модели).
- ОЗУ: 4–8 ГБ.
- CPU: Любой современный (2-4 ядра).
- Диск: модель + mmproj ≈ 2-3 ГБ суммарно.

2. Для локальных режимов (SOLO / DUAL):
- GPU: RTX с 8 ГБ VRAM. (RTX 2060 SUPER) или аналогичная карта от AMD
- ОЗУ: 16 ГБ .
- CPU: любой 4–8 ядер.
- Диск: модель + mmproj ≈ 6–8 ГБ суммарно.

На самом деле я смог запустить даже на GTX 950 (2 GB), 8 ОЗУ и I7 4770, но опыт не из приятных. Просто всё довольно медленно.

Так же внизу будут тесты на моем ПК

### УСТАНОВКА
1) Скачать
2) Распаковать в удобное место (желательно на SSD и в папку без русских символов)
3) Запустить

### НАСТРОЙКА
#### При запуске появится окно с настройками и область, которая будет переводить и выводить перевод, область можно перемещать, увеличивать, уменьшать, разделять, добавлять.
<img width="979" height="788" alt="image" src="https://github.com/user-attachments/assets/15cd6831-1283-4840-83bf-6871fac087e2" />

### Меню "Главное"

#### 1)Кнопка "Начать перевод" 
- Запускает сервер с AI и начинает захватывать и переводить текст под областью (ВАЖНО, ЕСЛИ ПЕРЕВОДЧИК УЖЕ ЗАПУЩЕН И У ВАС ВКЛЮЧЕН РЕЖИМ НАСТРОЙКИ РАМКИ (CTRL+ALT+F2), ТО ПЕРЕВОД НЕ БУДЕТ РАБОТАТЬ, ЭТО СДЕЛАНО ДЛЯ ТОГО, ЧТО БЫ НЕ НАГРУЖАТЬ СИСТЕМУ, ПОКА ВЫ НАСТРАИВАЕТЕ РАМКУ ВО ВРЕМЯ ИГРЫ)
<img width="2546" height="1427" alt="image" src="https://github.com/user-attachments/assets/8be93fd9-c022-478b-b294-2163ef329132" />

<img width="2300" height="596" alt="Снимок экрана 2025-11-06 015847" src="https://github.com/user-attachments/assets/3c0ab082-d883-4a9b-b496-dc05f042fc97" />

<img width="2560" height="1440" alt="image" src="https://github.com/user-attachments/assets/2da2d6d3-1de2-4b58-b067-29734996ca24" />

<img width="2560" height="1440" alt="image" src="https://github.com/user-attachments/assets/64081d11-3ea7-454b-8f8f-841848474986" />


#### 2) Там же есть переключатель режима работы программы. 
- При нажатии выпадет список со списком возможных режимов работы. Соло, Дуо и онлайн.
<img width="297" height="65" alt="image" src="https://github.com/user-attachments/assets/006cb908-15c6-4df2-806b-892173de9dd6" />

#### 2) Выбор языка. 
- Выбор с какого языка переводить текст
<img width="249" height="59" alt="image" src="https://github.com/user-attachments/assets/3b98e356-c34c-42f0-b48d-5145c3b208ad" />


#### 4) Окно для захвата
- Выберите процесс игры или необходимой программы
<img width="975" height="81" alt="image" src="https://github.com/user-attachments/assets/75ca17b9-448d-4670-b088-52e0d8e37f4f" />

#### 5) Модели 
- Выберите необходимые модели (Для соло режима только две: VL модель и mmproj модель. Для дуо три: VL модель и mmproj для чтение текста и простая для перевода. Для онлайна так же две:VL модель и mmproj модель).
- SOLO: Одна нейросеть делает всё (читает картинку и переводит). Среднее качество, так как сложнее в реализации
<img width="875" height="112" alt="image" src="https://github.com/user-attachments/assets/c12bf9bd-2ca8-4906-9e2d-4d7397dea2b1" />


- DUAL: Работают две модели. Маленькая читает текст, большая переводит. Немного медленее, чем Соло, гибче в настройке, качественее работает.
<img width="878" height="135" alt="image" src="https://github.com/user-attachments/assets/06e3ae01-940e-48ac-8430-91aaecd813a5" />

- ONLINE: Нейросеть читает текст, перевод через Google. Мгновенно, работает на любом ПК, но не понимает Лор и контекст.
<img width="872" height="108" alt="image" src="https://github.com/user-attachments/assets/8623c9f7-eb0e-4bac-aa43-2362a74ac509" />


#### 6) Лор файл и "Фразбук"
- Небольшой сборник терминов для нейросети, что бы она правильно переводила имена (определяла их пол, если персонаж женщина, а так же подстраивала перевод под нее), термины, фракции, организации и т.д. Можете сделать сами или с помощью той же онлайн нейросети попросить создать его (напишите примерно: Дай краткое описание всех персонажей (пол и т.д), терминов, фракций, организаций и т.д игры "название игры", а так же перевод всего этого с английского на русский (или другой интересующий вас язык, перевод с поднебесной и других языков поддерживается). Если лора нет, оставьте пустым (перевод может ухудшиться). Тоже самое и с "Фразбуком", я использую его для помощи с переводом некоторых спорных моментов (помогает избавиться от "я твоя не понимать" По умолчанию находится в "GameTranslator/_internal/assets"

#### ВНИМАНИЕ: Функции Лора, Фразбука НЕ РАБОТАЮТ в режиме ONLINE. Google Translate переводит каждое предложение отдельно и не умеет запоминать имена персонажей.
<img width="944" height="142" alt="image" src="https://github.com/user-attachments/assets/ed08a76d-78d8-461b-aaba-fc89bbb6f55d" />

<img width="467" height="335" alt="Снимок экрана 2025-11-07 003407" src="https://github.com/user-attachments/assets/92816f08-c148-485e-b4c1-ce0ac2393327" />

### Меню "Кастомизация"

#### 1) Смена шрифта, его размера и толщина
- Тут всё просто, там все шрифты в вашей системе, выбирайте любой и подгоняйте размер как вам нужно.
<img width="875" height="130" alt="image" src="https://github.com/user-attachments/assets/0fe3c694-1e4d-4646-b080-3d73fc2a6d7a" />



<img width="869" height="389" alt="image" src="https://github.com/user-attachments/assets/5b79cf9d-3c71-4308-b375-24026ac09669" />


#### 2) Фпс захвата
- Как часто будет делать скриншот области для отправки нейросети. Если значение низкое, а система не успевает, то будет работать просто на пределе возможного, но ничего не сломается.

#### 3) Умное удаление имен
- Программа будет удалять имена говорящего, что бы они не выводились в переводе. Это будет полезно, если вы захватываете и имя и сам текст. Нейросеть и код будет понимать, что это имя и будет пытаться определять пол говорящего.

#### 4) Проверок EN до фиксации
- Сколько проверок текста должно произойти что бы текст "застыл", то есть перестал пытаться перевести. Может быть полезным, если текст написан дураком и переводчику сложно перевести с первого раза.

#### 5) Ширина рамки/разделителя
- Ширина рамки/разделителя)

#### 6) Плавный вывод
- Текст печатается по символам (плавно) (имитация новел и гач)

#### 7) Overlay по боксам
- Подключает еще одну OCR, которая анализирует местоположение текста и подставляет перевод поверх оригинала (Нагружает только CPU, небольшие скачки до 50% в моём случае)

#### 8) Скрыть консоль
- Скрывает консоль моделей в LLM (Если модель вылетет вы это не поймете, на первое время рекомендую оставить консоли, потом можно выключить)

#### 9) Память нейросети
- Записыается в файл последние 20 выводов, что может помочь в диалогах для правильного перевода

#### ВНИМАНИЕ: Функция память диалогов НЕ РАБОТАЮТ в режиме ONLINE. Google Translate переводит каждое предложение отдельно и не умеет запоминать имена персонажей.

#### 10) Ручка рамки
- Меняет размер уголка

#### 11) Фон и интенсивность
- Меняет фон для режима обычного вывода и режима "подставлять под оригинал", так же можно настроить силу размытия/затемнения

### Меню "Загрузки"
- Можно скачать модели прямо тут, можно вставить ссылку на модель или выбрать уже из списка, я добавил и рассписал какая модель к чему
<img width="978" height="789" alt="image" src="https://github.com/user-attachments/assets/6ed724bb-ea81-45c4-8d4d-7c6cd48c83a2" />

### Меню "Настройка моделей"
### ВСЕ ЧТО ИДЕТ ДАЛЬШЕ ВЛИЯЕТ НА ВАШУ ПРОИЗВОДИТЕЛЬНОСТЬ И РАБОТУ ИИ В ЦЕЛОМ, В КОНЦЕ Я ДАМ НЕБОЛЬШУЮ СВОДКУ, ЧТО ЗА ЧТО ОТВЕЧАЕТ И КАКОЕ ВЛИЯНИЕ НА ПРОИЗВОДИТЕЛЬНОСТЬ И РАБОТУ ИИ.
<img width="977" height="1281" alt="image" src="https://github.com/user-attachments/assets/c357e262-41b5-4b19-bc40-2839c742a5a3" />


#### Краткая сводка что за что отвечает
- Flash Attention - снижает раход памяти (если модели закрываются, первым делом пробуйте выключить)
- cache_promt - загружается ли промпт+лор в память. Пусть всегда включено, если не используете иначе
- Сжатие кеша - Так же снижает раход, модели могут немного поглупеть, но совсем немного (Если по простому, то мы делаем нейросети небольшую лаботомию, вырезаем часть знаний, но делаем её легче)
- max_tokens = максимальный размер ответа AI (сколько букв в переводе, столько и токенок, но слишком большое значение ставить не надо, если модель сойдет с ума, то выдаст 999999 символом и произойдет вылет)
- timeout - максимальное время овета AI, если не справился сбрасывает ответ и по новой думает (если словил жесткий затуп может помочь)
- temperature - "креативность" AI
- top_p - та же "креативность", но в другом плане.
- top_k - еще одна "креативность" (да, ее нужно много, что бы ограничивать или наоборот дать простор в переводе)
- repeat_penalty - БОЛЬШЕ КРЕАТИВНОСТИ
- seed - не смешно уже, опять креативность
- slot_id - место для вашего лора и промпта, по умолчанию 0, пусть и отсается 0.
- ctx-size - Сколько токенов/текста уместится в запросе+истории+лор (всё это хранится в самой нейросети, что бы она не забывала, кто есть кто)
- batch-size - Грубо говоря, сколько информации может пропустить через себя нейросеть за раз. Влияет на пропускную способность и немного на VRAM
- ubatch-size - То же самое, главный «жир» по VRAM
- parralel - Параллельные запросы к серверу. Грубо говоря, может обрабатывать несколько запросов сразу. Для нескольких областей может ускорить работу, но VRAM растёт почти линейно.
- ngl - Ниже = меньше жор GPU. Выше = больше жор на GPU. Всё просто. можете оставить 999 и проверить как работает (будет брать столько, сколько ему надо, не больше).
- host - не трогайте, если не знаете как (меняйте, если используете модели на другом ПК (как я), вписывайте IP другого компа)
- port - то же самое
#### Настроить промпт
- Позволяет в ручную настраивать промпт для нейросети
#### Предпросмотр промпта
- Показывает текущий промпт. Мной уже загружен промпт, можете использовать его как шаблон для своего. (В сам код намертво вшит мой промпт, но если введете свой, то он просто заменится на ваш, если захотите вернуть как было, то просто сотрите и он подтянется автоматом)

<img width="1298" height="1213" alt="image" src="https://github.com/user-attachments/assets/6f0b8090-1e19-4f29-9fa5-95baf0ba3f44" />

#### 9) Настройка самой области
- Потяните за любой уголок что бы растянуть/стянуть область.
- Потяните за рамку, что бы перенести область
- CTRL+ALT+N - создать новую область
- CTRL+ALT+D - разделить область на две отдельные, область захвата (оранжевая) и область перевода (синяя). И так же что бы соединить обратно
- TAB - сменить редактирование между захватом и переводом
- Delete (перед этим нажмите на нужную область) - удалить область
- CTRL+ALT+F1 - проявить/скрыть перевод/область
- CRTL+ALT+F2 - проявить/скрыть рамки
- CTRL+ALT+Q - выход в настройки

Пока что это все настройки что есть, возможно что-то добавится, а что-то уберется.


После всех настроек и изменений области под себя, жмите кнопку "Начать перевод" (Меню "Главное"), через некоторое время, если все сделали правильно, появится перевод текста.
### ПОМНИТЕ, ЧТО ЭТО Я ВСЁ ДЕЛАЛ ДЛЯ СЕБЯ И ПРОСТО РЕШИЛ ПОДЕЛИТЬСЯ СО ВСЕМИ, ТАК ЧТО ВОЗМОЖНЫ ОШИБКИ. ТАК ЧТО ПИШИТЕ О БАГАХ, НЕДОРАБОТКАХ, БУДУ ИСПРАВЛЯТЬ ПО ВОЗМОЖНОСТИ. ЕСЛИ ВЫ ЗНАЕТ КАК МОЖНО ДОРАБОТАТЬ ТОТ ИЛИ ИНОЙ АСПЕКТ ПРОГРАММЫ БУДУ ПРИЗНАТЕЛЕН.

### КАК И ОБЕЩАЛ БОЛЕЕ ДЕТАЛЬНОЕ ОПИСАНИЕ ДЛЯ НАСТРОЕК И ПРИМЕРНЫЕ ПРЕСЕТЫ ДЛЯ ОБЫЧНОГО ПК:

1) Модель
##### Минимальная связка для соло и дуо:
- Соло: Qwen-VL-4B + mmproj F16 (минимальная нагрузка и так себе перевод)
- Дуо: (Qwen-VL-2B + mmproj F16) + Qwen-4B (без VL) (Нагрузка чуть больше, но повторов должно быть меньше)
- Онлайн: (Qwen-VL-2B + mmproj F16)


##### Средняя свяка для соло и дуо:
- Соло Qwen-VL-8B + mmproj F16 (Умеренная нагрузка и нормальный перевод (возможны повторы/обновление текста (вроде как поборол этот момент, но всё может быть))
- Дуо (Qwen-VL-2B + mmproj) + Qwen-8B (без VL) (Нагрузка чуть выше, но повторов меньше)
- Онлайн: (Qwen-VL-2B + mmproj F16)

- Можно вообще попробовать всё на Qwen-VL-2B запустить, получится потраченый перевод из GTA:SA, но зато нагрузка еще меньше (ну и смешно будет)


2) ctx-size (контекст)
- Сколько токенов уместится в запросе+истории. ↑ctx = ↑VRAM/KV-кеш, стабильнее длинные сцены.
- Средне: 2048 (8 GB VRAM) / 4096 (12–16 GB).

3) ngl (GPU-layers, «999» = максимум)
- Сколько слоёв модели держать на GPU. ↑ngl = ↑VRAM, но сильно быстрее. При OOM (Ошибка по памяти) снижать.
- Средне: 999 (пусть сам возьмёт максимум). Если не лезет — 50–90. Для CPU режима ставьте 0

4) batch-size
- Размер партии токенов на шаге. Влияет на пропускную способность и немного на VRAM.
- Средне: 64-128 (8 GB) / 128-256 (12–16 GB).

5) ubatch-size
- Подпартия, главный «жир» по VRAM. Первый рычаг при OOM/фризах.
- Средне: 32-64 (8 GB) / 64-128 (12–16 GB).

6) parallel
- Параллельные запросы к серверу. Для нескольких областей может ускорять, но VRAM растёт почти линейно.
- Средне: 1. Если 2 — урезать ubatch.

7) max_tokens (лимит ответа)
- Только на ответ, не на вход. ↑значение = дольше, чуть ↑память.
- Средне: 2000.

8) temperature
- Стохастичность. Для перевода держи низко (стабильность терминов).
- Средне: 0.00–0.25. (пробуйте с 0)

9) top_p
- Nucleus-сэмплинг. Чем ниже — тем консервативнее.
- Средне: 0.9–1. (пробуйте с 1)

10) top_k
- Сэмплинг по top-k токенам. Для перевода чаще 0 (выкл.).

11) repeat_penalty
- Штраф за повторы. Слегка ↑ для борьбы с заиканием.
- Средне: 1.00–1.08. (пробуйте с 1.00)

12) seed
- 0 = псевдослучайность каждый раз. Фиксируй (>0) для воспроизводимости.
- Средне: 0 (если не нужно «один-в-один»). (Для соло ставьте 1, для дуо 0)

13) timeout
- HTTP-таймаут запроса к серверу (сек).
- Средне: 12–18 s (под длину кадров/контекст).


### Что крутить при проблемах:
1) OOM/500 (ошибка в консоле)/фризы: снижать ubatch → batch → ctx (в таком порядке)
2) Ошибка контекста: Повысить контекст минимум до значения, которое выдает консоль
3) Медленно отвечает: снизить ctx или max_tokens, поднять batch (если есть VRAM)
4) Перевод «гуляет»: temperature вниз (до 0), top_k=0, repeat_penalty≈1, включить seed>0 (если нужна стабильность).
5) Вылет при старте: Либо память забилась и модель вылетела, либо сама модель не хочет работать.

### Попробуйте значения по умолчанию, так же прилагаю скрин нагрузки до и после запуска сервера (режим дуо: (Qwen-VL-2B + mmproj F16) + Qwen-4B (без VL))
#### Моё железо:
- I7 12700KF
- 32 ГБ ОЗУ
- RTX 4070 Ti Super

### И нагрузка до и после (на новых версия еще меньше, но пусть будет как пример "жесть режима")
- до
<img width="1155" height="699" alt="Снимок экрана 2025-11-10 191704" src="https://github.com/user-attachments/assets/f7344b7d-bb10-4ce9-b233-1d08d5ae5574" />

- после
<img width="1163" height="704" alt="Снимок экрана 2025-11-10 191851" src="https://github.com/user-attachments/assets/4a569145-ef03-480e-a75f-70b5b723a89b" />


### Фууух, ну вроде все расписал, если что-то не понятно, нашли баг, есть предложение, создавайте issue, отвечу, прислушаюсь. ( Я ЗНАЮ ЧТО ПРАВИЛЬНО TRANSLATOR, ЕТА ФИШКА!!!)
